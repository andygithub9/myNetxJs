import Head from 'next/head'

export default function frameworksGithubStarts(props) {
  const { datalist } = props
  return (
    <div>
      <Head>
        <title>frameworks-github-starts</title>
        <meta name="description" content="Generated by create next app" />
        <link rel="icon" href="/favicon.ico" />
      </Head>

      <div>
        <ul>
          {
            datalist.map(ele => (
              <li key={ele.name}>{ele.name} starts: {ele.stars}</li>
            ))
          }
        </ul>
      </div>
    </div>
  )
}

// getStaticProps 在服務器端會執行，在編譯(build)時也會執行
export async function getStaticProps(context) {
  console.log('frameworksGithubStarts getStaticProps is running...');

  let res = await fetch('https://api.github.com/repos/facebook/react')
  let json = await res.json()
  let starts_react = json.stargazers_count
  console.log(starts_react);

  res = await fetch('https://api.github.com/repos/vuejs/vue')
  json = await res.json()
  let starts_vue = json.stargazers_count

  res = await fetch('https://api.github.com/repos/angular/angular')
  json = await res.json()
  let starts_angular = json.stargazers_count

  return {
    props: {
      datalist: [
        { name: 'React', stars: starts_react },
        { name: 'Vue', stars: starts_vue },
        { name: 'Angular', stars: starts_angular }
      ]
    }
  }
}
